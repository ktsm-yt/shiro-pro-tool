# 城プロ編成ツール

城プロREのキャラクター管理・編成作成・バフ可視化と簡易ダメージ計算をブラウザだけで行えるシングルページアプリ。  
最終更新: 2025-11-20

## 主な機能
- **キャラクター管理**: 追加/編集/削除。編成特技・特技・計略をバフ文字列で登録。
- **Wiki URLインポート**: `https://scre.swiki.jp/` のキャラページURLを貼ると、武器種/属性/期間を自動入力し、特技・計略テキストを表示。1クリックでテキスト解析しバフリストへ追加可。
- **編成作成 & 保存**: 最大8人を編成。ブラウザLocalStorageへ自動保存、JSONでエクスポート/インポート可能。
- **編成比較**: 複数編成のバフ/デバフ強度をグラフ表示。
- **簡易ダメージ計算**: 行を積み上げる方式で「基礎攻撃→固定加算→割合→与ダメ/被ダメ等」を計算し、複数プロファイルをカードで並べて比較。
- **ダメージ計算(β)**: 登録済みのバフ/デバフを自動集計し、敵防御・HPや計略ON/OFF、ヒット数を指定して合計ダメージを試算。条件付きバフは手動トグル式。

## 使い方（クイックスタート）
1. `index.html` をブラウザで開く（CORS回避が不要ならローカルファイルでOK。Wiki取得が失敗する場合は簡易ローカルサーバーを推奨）。
2. 「キャラクター管理」タブ  
   - 既存データ: `data/sample-characters.json` を「インポート」して読み込み。  
   - Wiki取り込み: 上部「Wiki URLからインポート」にURLを貼り「URLから取得」。特技/計略テキスト横の「解析」ボタンでバフとしてリストに追加。  
   - 直接入力: 対象/バフ種/数値/条件を入力して追加。重複フラグも設定可。
3. 「編成作成」タブで編成を組み保存。比較したい編成は「編成比較」で選択。
4. 「簡易ダメージ計算」タブでプロファイルを追加し、行を編集してダメージを概算。防御や鼓舞値はグローバル設定で一括変更できます。
5. 「ダメージ計算(β)」タブでキャラクターを選ぶと登録済みバフを自動反映した計算が行われます。条件付きバフは右側のチェックボックスでON/OFF。

## データ管理
- 保存場所: LocalStorage  
  - キャラクター: `shiroProCharacters`  
  - 編成: `shiroProFormations`  
  - 簡易ダメージプロファイル: `simpleDamageProfiles` / 設定 `simpleDamageSettings`
- エクスポート/インポート: 「キャラクター管理」タブのデータ管理セクションから JSON を入出力。

### データフォーマット
`data/` にサンプルあり。キャラクターデータ構造は以下を基準にしています（バフは文字列で保持）。
```json
{
  "id": 1,
  "name": "キャラ名",
  "period": "絢爛 など任意",
  "weapon": "武器種",
  "weaponRange": "遠 or 近",
  "weaponType": "物 or 術",
  "placement": "遠 or 近 or 遠近",
  "attributes": ["水", "平"],
  "skills": ["射程内/攻撃割合+%40"],
  "formationSkills": [],
  "strategies": []
}
```

## 現状の開発メモ
- Wikiインポートは CORS プロキシ（`corsproxy.io` / `api.codetabs.com` / `api.allorigins.win`）を順番に試行。失敗時はローカルサーバー起動かブラウザ拡張でCORS無効化が必要。
- ダメージ計算(β): HP依存・時間経過・多敵対応・DPS算出は未実装。条件付きバフは手動トグルで適用。
- ファイル分割・ビルドツール導入は未着手。現状は `index.html` + `js/app.js` の単一ページ構成。

## 貢献
PRやIssue歓迎です。ブランチ名・コーディング規約は定めていませんが、変更点が分かるように小さめのコミットを推奨します。
